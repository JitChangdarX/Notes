"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8467],{19132:function(e,t,n){n.d(t,{BZ:function(){return b},Bl:function(){return K},LZ:function(){return w},M1:function(){return p},QD:function(){return I},gb:function(){return x},hJ:function(){return v},j5:function(){return A},sf:function(){return S},tc:function(){return h},te:function(){return D},xm:function(){return U},xn:function(){return _}});var r=n(19170),u=n(5362),a=n(27218),i=n(27895),o=n(30947),s=n(13262),l=n(87033),c=n(10228),d=n(88755),f=n(77930),g=n(81695),y=n(7653);let v=e=>e.type===c.Fg.GITHUB?{sync_source_type:c.Fg.GITHUB,sync_source_config:e.config}:e.type===c.Fg.GDRIVE?{sync_source_type:c.Fg.GDRIVE,sync_source_config:e.config}:null,h=()=>{let{activeOrganization:e}=(0,a.t)(),t=null==e?void 0:e.uuid;return(0,u.WE)("/api/organizations/".concat(t,"/sync/settings"),{queryKey:[s.FU,{orgUUID:t}],enabled:!!e})},p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:t}=(0,a.t)(),n=null==t?void 0:t.uuid,r=(0,f.useQueryClient)();return(0,u.Ne)("/api/organizations/".concat(n,"/sync/settings"),"PUT",(e,t)=>{let{type:n,enabled:r}=e;t||(t=[]);let u=t.map(e=>e.type===n?{...e,enabled:r}:e);return u.some(e=>e.type===n)?u:[...t,{type:n,enabled:r}]},{queryKey:[s.FU,{orgUUID:n}],enabled:!!t,onSuccess:async function(){for(var t,u=arguments.length,a=Array(u),i=0;i<u;i++)a[i]=arguments[i];await r.invalidateQueries({queryKey:[s.FU,{orgUUID:n}]}),await (null===(t=e.onSuccess)||void 0===t?void 0:t.call(e,...a))},meta:{errorMessage:"There was an error changing your settings. Please try again."},...e})},_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:t}=(0,a.t)(),n=null==t?void 0:t.uuid,r=(0,f.useQueryClient)(),{value:i}=(0,l.FL)("kingfisher_enabled"),{value:o}=(0,l.FL)("apps_use_bananagrams");return(0,u.Ne)("/api/organizations/".concat(n,"/sync/settings/config"),"POST",(e,t)=>{let{type:n,config:r}=e;return t||(t=[]),t.map(e=>e.type===n?{...e,config:{...e.config,...r}}:e)},{queryKey:[s.FU,{orgUUID:n}],enabled:!!(t&&i&&o),onSuccess:async function(){for(var t,u=arguments.length,a=Array(u),i=0;i<u;i++)a[i]=arguments[i];await r.invalidateQueries({queryKey:[s.FU,{orgUUID:n}]}),await (null===(t=e.onSuccess)||void 0===t?void 0:t.call(e,...a))},meta:{errorMessage:"There was an error changing your settings. Please try again."},...e})},m=(e,t)=>{let n=new URLSearchParams(Array.from(t.entries()));n.delete(e);let r=n.toString()?"?".concat(n.toString()):"",u=window.location.pathname+r;window.history.replaceState({...window.history.state,as:u,url:u},"",u)},b=e=>{let{callerIdentifier:t,successParam:n,handleOpen:r}=e,u=(0,g.useSearchParams)(),a=(0,y.useRef)(!1);(0,y.useEffect)(()=>{!u.has(n)||a.current||t&&t!==u.get(n)||(a.current=!0,m(n,u),r())},[u,t,r,n])},w=e=>{let{pathname:t,searchParams:n,queryString:r,isClaudeApp:u}=e,a="".concat(t,"?").concat(r),i=n.get("origin");if(i)a=i;else if(u){let e=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i,n=t.startsWith("/project/")&&e.test(t.slice(9)),u=t.startsWith("/chat/")&&e.test(t.slice(6));a="claude://claude.ai".concat(n||u||"/new"===t?t:"/new","?").concat(r)}return a},C=e=>[c.co.CREATED,c.co.PENDING,c.co.UPDATING].includes(e),S=e=>C(e.status.state),U=e=>[c.co.FAILED,c.co.UPDATE_FAILED].includes(e.status.state),E=e=>{if(e instanceof o.Hx)return e instanceof o.Hx&&"access_denied"===e.errorCode},x=()=>{let{addError:e}=(0,i.e)(),t=(0,f.useQueryClient)();return(n,r)=>{E(n)&&(e("Please try again. You may need to reconnect with your ".concat(c.hP[r.sync_source_type]," account.")),s.Su.forEach(e=>{t.invalidateQueries({queryKey:[e]})}),t.invalidateQueries({queryKey:[s.cF]}))}},P={[c.Fg.GCAL]:"enabled_foccacia",[c.Fg.GMAIL]:"enabled_sourdough"},Q=e=>{let t=e===c.Fg.GCAL||e===c.Fg.GMAIL?"pumpernickel_enabled":"cinnabon_enabled",{value:n}=(0,l.FL)(t);return n},T=e=>{let t=(0,a.Cf)(),{data:n}=h(),r=!!(Array.isArray(n)&&n.find(t=>t.type===e&&t.enabled));return!t||r},D=e=>{let t=(0,a.rW)(),n=T(e);return!!(Q(e)&&n&&t)},q=e=>"sfdc"===e?"salesforce":e,I=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:n}=(0,a.t)(),r=null==n?void 0:n.uuid,i=(0,g.useRouter)(),o=(0,g.usePathname)(),s=(0,g.useSearchParams)(),{callerIdentifier:l,handleAuthSuccess:c}=t,v=D(e),h=(0,f.useQueryClient)(),p=(0,d.Q)(),{data:_,isFetched:m}=(0,u.WE)("/api/organizations/".concat(r,"/sync/").concat(q(e),"/auth"),{queryKey:["sync_".concat(e,"_auth_status"),{orgUUID:r}],enabled:!!(n&&v)}),C=(0,y.useRef)(!1),{mutate:S}=(0,u.uC)("/api/organizations/".concat(r,"/sync/").concat(q(e),"/auth/start"),"POST",{enabled:!!(n&&v),onSuccess:e=>{i.push(e.redirect_url)}});b({callerIdentifier:l,successParam:"".concat(e,"_success"),handleOpen:()=>null==c?void 0:c(!0)});let{mutate:U}=(0,u.uC)("/api/organizations/".concat(r,"/sync/").concat(q(e),"/auth"),"DELETE",{enabled:!!(n&&v),onSuccess:()=>{h.invalidateQueries({queryKey:["sync_".concat(e,"_auth_status"),{orgUUID:r}]})}});return{isAuthenticated:v&&!!(null==_?void 0:_.is_authenticated),startAuth:()=>{if(!C.current&&v){let t=w({pathname:o,searchParams:s,queryString:"".concat(e,"_success=").concat(l),isClaudeApp:p});if(p){window.open("/settings/profile?open_in_browser=1&auth_start=".concat(e,"&origin=").concat(t));return}C.current=!0,S({pre_auth_state:{origin:t},redirect_uri:new URL("/connect/".concat(q(e),"/callback"),window.location.origin).toString()})}},disconnect:U,isFetched:m}},A=(e,t)=>{var n,r;let u=D(e),{account:i}=(0,a.t)(),o=P[e];return o?u&&(t?!!(null==t?void 0:null===(n=t.conversationSettings)||void 0===n?void 0:n[o]):!!(null==i?void 0:null===(r=i.settings)||void 0===r?void 0:r[o])):u},K=()=>{let{account:e}=(0,a.t)(),{mutate:t}=(0,r.Ck)();return{toggleIntegrationEnabled:(n,r)=>{if(!e)return;let u=P[n];u&&t({...e.settings,[u]:r})}}}},22534:function(e,t,n){n.d(t,{F7:function(){return i},MU:function(){return a},ZZ:function(){return o}});let r="recentDriveDocs";function u(e){return"object"==typeof e&&null!==e&&"string"==typeof e.uri&&("string"==typeof e.title||void 0===e.title)}function a(e){localStorage.setItem(r,JSON.stringify(e))}function i(){let e=localStorage.getItem(r);if(e){let t=JSON.parse(e);if(t&&Array.isArray(t)&&t.every(u))return t}return[]}function o(e){let t=i();a(t=t.filter(t=>t.uri!==e))}},28803:function(e,t,n){n.d(t,{V0:function(){return b},bf:function(){return w},OD:function(){return G},m:function(){return S},$Y:function(){return Q},$H:function(){return P},j1:function(){return T},f7:function(){return D},Pe:function(){return U},j7:function(){return M},Rq:function(){return _},Cy:function(){return I},cE:function(){return m},CJ:function(){return A},_C:function(){return E},QR:function(){return C},y6:function(){return z},cc:function(){return x},gm:function(){return q},Ke:function(){return B},T$:function(){return R},fc:function(){return O},W:function(){return j},PD:function(){return K},Gk:function(){return H},gK:function(){return L},Ls:function(){return k},jl:function(){return N}});var r=n(3053),u=n(5362),a=n(27218),i=n(1812),o=n(98731),s=n(13262),l=n(7653);function c(e){let t=JSON.stringify(e);return(0,l.useMemo)(()=>e,[t])}var d=n(51432),f=n(77930),g=n(50803),y=n(87590),v=n.n(y),h=n(81695),p=n(1146);let _=e=>{let t=(0,f.useQueryClient)(),{activeOrganization:n}=(0,a.t)(),r=null==n?void 0:n.uuid,[u,i]=(0,l.useReducer)(e=>e+1,0),o=c([s.I8,{orgUUID:r},{uuid:e}]),d=(0,l.useMemo)(()=>t.getQueryData(o),[t,o,e,u]);return(0,l.useEffect)(()=>t.getQueryCache().subscribe(e=>{"updated"===e.type&&"success"===e.action.type&&(0,g._x)({queryKey:o},e.query)&&i()}),[t,i,o]),{data:d}},m=e=>{let t=(0,f.useQueryClient)(),{activeOrganization:n}=(0,a.t)(),r=null==n?void 0:n.uuid,u=c([s.I8,{orgUUID:r},{uuid:e}]);return t.getQueryData(u)},b=30,w=1e4,C=e=>{let{activeOrganization:t}=(0,a.t)(),n=null==t?void 0:t.uuid,r=new URLSearchParams,{limit:i,offset:o,enabled:l,starred:c}=e;void 0!==i&&r.append("limit",i.toString()),void 0!==o&&r.append("offset",o.toString()),void 0!==c&&r.append("starred",c.toString());let d=r.toString();return d=d?"?".concat(d):"",(0,u.WE)("/api/organizations/".concat(null!=n?n:"","/chat_conversations").concat(d),{queryKey:[s.tv,{orgUUID:n},{limit:i,offset:o,starred:c}],staleTime:3e5,enabled:!!n&&l})},S=()=>{let{activeOrganization:e}=(0,a.t)(),t=null==e?void 0:e.uuid;return(0,u.WE)("/api/organizations/".concat(t,"/chat_conversations/count"),{queryKey:[s.Dn,{orgUUID:t}],staleTime:3e5,enabled:!!t})},U=()=>{let{activeOrganization:e}=(0,a.t)(),t=(0,u.OJ)();return(0,l.useCallback)(async n=>{let{limit:r,offset:u}=n,a=new URLSearchParams;void 0!==r&&a.append("limit",r.toString()),void 0!==u&&a.append("offset",u.toString());let i=a.toString();return i=i?"?".concat(i):"",(await t("/api/organizations/".concat(null==e?void 0:e.uuid,"/chat_conversations").concat(i))).json()},[null==e?void 0:e.uuid,t])},E=function(e){let{suppressError:t,enabled:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0},{activeOrganization:r}=(0,a.t)(),i=null==r?void 0:r.uuid,o=(0,l.useRef)([]),c=(0,f.useQueryClient)(),d="/api/organizations/".concat(null!=i?i:"","/chat_conversations/").concat(e,"?tree=True&rendering_mode=messages&render_all_tools=true"),g=(0,u.WE)(d,{queryKey:[s.I8,{orgUUID:i},{uuid:e}],staleTime:3e5,enabled:!!i&&!!e&&n,meta:{noToast:t}},t=>(c.invalidateQueries({queryKey:[s.Gj,{orgUUID:i,conversationUUID:e}]}),(0,p.fX)(t))),y=(0,l.useMemo)(()=>{if(!g.data)return o.current=[],o.current;let e=(0,p.kX)(g.data);if(e.length!==o.current.length||e.some((e,t)=>{var n;return e.uuid!==(null===(n=o.current[t])||void 0===n?void 0:n.uuid)}))return o.current=e,o.current;for(let t=0;t<e.length;t++)v()(e[t],o.current[t])||(o.current[t]=e[t]);return o.current},[g.data]);return{...g,currentPath:y}},x=e=>{let t=(0,f.useQueryClient)(),{activeOrganization:n}=(0,a.t)(),r=null==n?void 0:n.uuid;return(0,l.useCallback)(()=>{t.invalidateQueries({queryKey:[s.I8,{orgUUID:r},{uuid:e}]})},[t,r,e])},P=(e,t)=>{let{mutate:n}=Q(),r=(0,h.useRouter)(),u=t||(0,d.H)();return(0,l.useCallback)(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{model:void 0,controlsOpen:!1},a={uuid:u,name:"",model:t.model};t.projectUuid&&(a.project_uuid=t.projectUuid),n(a);let i="/chat/".concat(u).concat(t.controlsOpen?"?controls=1":"");r[e](i)},[n,r,e,u])},Q=()=>{let{activeOrganization:e}=(0,a.t)(),t=null==e?void 0:e.uuid,n=(0,f.useQueryClient)(),r=[s.tv,{orgUUID:t}],i=e=>[s.ph,{orgUUID:t},{uuid:e}],o=e=>[s.I8,{orgUUID:t},{uuid:e}];return(0,u.uC)("/api/organizations/".concat(null!=t?t:"","/chat_conversations"),"POST",{enabled:!!t,async onMutate(e){let t=i(e.uuid);await Promise.all([n.cancelQueries({queryKey:r}),n.cancelQueries({queryKey:t})])},onSuccess:e=>{n.invalidateQueries({queryKey:[s.tv,{orgUUID:t}]}),n.setQueryData(o(e.uuid),t=>({...t||{},...e,chat_messages:(null==t?void 0:t.chat_messages)||[],messageByUuid:new Map,parentByChildUuid:new Map,childrenByParentUuid:new Map,selectedChildByUuid:new Map})),W(n,t)},onError(e,t){n.setQueryData(r,e=>null==e?void 0:e.filter(e=>e.uuid!==t.uuid)),n.setQueryData(i(t.uuid),void 0)}})},T=()=>{let{activeOrganization:e}=(0,a.t)(),t=null==e?void 0:e.uuid,n=(0,f.useQueryClient)();return(0,u.Ne)(e=>{let{uuid:n}=e;return"/api/organizations/".concat(null!=t?t:"","/chat_conversations/").concat(n)},"DELETE",(e,t)=>{let{uuid:n}=e;if(!t)return[];let r=t.findIndex(e=>e.uuid===n);if(!(r>-1))return t;{let e=[...t];return e.splice(r,1),e}},{enabled:!!t,queryKey:[s.tv,{orgUUID:t}],onSuccess:async(e,r)=>{let{uuid:u,projectUuid:a}=r;await n.invalidateQueries({queryKey:[s.I8,{orgUUID:t},{uuid:u}]}),a&&await n.invalidateQueries({queryKey:[s.lx,{orgUuid:t,projectUuid:a}]}),await W(n,t)}})},D=e=>{let{activeOrganization:t}=(0,a.t)(),n=null==t?void 0:t.uuid,r=(0,f.useQueryClient)();return(0,u.uC)("/api/organizations/".concat(n,"/chat_conversations/delete_many"),"POST",{onSuccess:async t=>{await W(r,n),e&&e(t)}})},q=()=>{let{activeOrganization:e}=(0,a.t)(),t=null==e?void 0:e.uuid,n=null==e?void 0:e.capabilities.includes("raven");return(0,u.WE)("/api/organizations/".concat(t,"/shares"),{queryKey:[s.PB,{orgUUID:t}],enabled:!!t&&n,staleTime:3e5})},I=e=>{let{activeOrganization:t}=(0,a.t)(),n=null==t?void 0:t.uuid;return(0,u.WE)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/latest"),{enabled:!!n&&!!e,queryKey:[s.Gj,{orgUUID:n,conversationUUID:e}],staleTime:0,meta:{noToast:!0}},e=>{let{snapshot:t,shareable:n,disabled_reason:r}=e;return{shareable:n,disabled_reason:r,snapshot:t?{...t,chat_messages:t.chat_messages.map(e=>(0,p.Dk)(e))}:null}})},A=e=>{let{activeOrganization:t,account:n}=(0,a.t)(),r=null==t?void 0:t.uuid,i=n&&r?"/api/organizations/".concat(r,"/chat_snapshots/").concat(e,"?rendering_mode=messages&render_all_tools=true"):"/api/chat_snapshots/".concat(e,"?rendering_mode=messages&render_all_tools=true");return(0,u.WE)(i,{retry:!1,refetchInterval:!1,enabled:!!e,staleTime:0,queryKey:[s.ld,{orgUUID:r,snapshotUUID:e}]},e=>({...e,chat_messages:e.chat_messages.map(e=>(0,p.Dk)(e))}))},K=e=>{let{activeOrganization:t}=(0,a.t)(),n=null==t?void 0:t.uuid,r=(0,f.useQueryClient)();return(0,u.uC)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/share"),"POST",{onSuccess:()=>{r.invalidateQueries({queryKey:[s.Gj,{orgUUID:n,conversationUUID:e}]}),r.invalidateQueries({queryKey:[s.PB,{orgUUID:n}]}),r.invalidateQueries({queryKey:[s.VH,{orgUUID:n}]})}})},k=(e,t)=>{let{activeOrganization:n}=(0,a.t)(),r=null==n?void 0:n.uuid,i=(0,f.useQueryClient)();return(0,u.uC)("/api/organizations/".concat(r,"/share/").concat(t),"DELETE",{enabled:!!r&&!!t,meta:{errorMessage:"There was an error while trying to unshare the conversation. Please try again."},onSuccess:()=>{i.invalidateQueries({queryKey:[s.Gj,{orgUUID:r,conversationUUID:e}]}),i.invalidateQueries({queryKey:[s.PB,{orgUUID:r}]}),i.invalidateQueries({queryKey:[s.VH,{orgUUID:r}]})}})},z=e=>{let{activeOrganization:t}=(0,a.t)(),n=null==t?void 0:t.uuid;return(0,u.WE)("/api/organizations/".concat(n,"/artifact-versions/").concat(e),{retry:!1,refetchInterval:!1,enabled:!!e,staleTime:0,queryKey:[s.qB,{artifactVersionUUID:e}]})},B=function(e,t,n){var o,l,c;let d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{track:g}=(0,r.z$)(),y=null!==(l=null===(o=(0,i.T)())||void 0===o?void 0:o.preview_feature_uses_artifacts)&&void 0!==l&&l,{activeOrganization:v}=(0,a.t)(),h=null==v?void 0:v.uuid,p=(0,f.useQueryClient)(),_=[s.I8,{orgUUID:h},{uuid:e}];return(0,u.uC)("/api/organizations/".concat(null!=h?h:"","/chat_conversations/").concat(e,"/chat_messages/").concat(null!==(c=t.uuid)&&void 0!==c?c:"","/chat_feedback"),t.chat_feedback?"PUT":"POST",{enabled:!!h,meta:{errorMessage:"We could not save your feedback. Please try again later."},...d,onSuccess(){for(var r,u,a=arguments.length,i=Array(a),o=0;o<a;o++)i[o]=arguments[o];g({event_key:"claudeai.conversation.feedback.sent",message_uuid:t.uuid,conversation_uuid:e,artifacts_enabled:y,conversationHasArtifacts:n,type:null===(r=t.chat_feedback)||void 0===r?void 0:r.type}),p.invalidateQueries({queryKey:_}),null===(u=d.onSuccess)||void 0===u||u.call(d,...i)}})},F=()=>{let e=(0,f.useQueryClient)(),{activeOrganization:t}=(0,a.t)(),n=null==t?void 0:t.uuid;return(0,l.useCallback)((t,r)=>{t&&(e.setQueryData([s.I8,{orgUUID:n},{uuid:t}],e=>e&&{...e,...r}),e.setQueriesData({queryKey:[s.tv,{orgUUID:n}]},e=>null==e?void 0:e.map(e=>e.uuid!==t?e:{...e,...r})))},[n,e])},j=e=>{let t=(0,f.useQueryClient)(),{activeOrganization:n}=(0,a.t)(),r=null==n?void 0:n.uuid,i=F();return(0,u.uC)("/api/organizations/".concat(r,"/chat_conversations/").concat(e),"PUT",{onMutate:n=>{var u;let{name:a}=n,o=t.getQueryData([s.I8,{orgUUID:r},{uuid:e}]);return i(e,{name:a}),{oldTitle:null!==(u=null==o?void 0:o.name)&&void 0!==u?u:""}},onError(t,n,r){r&&i(e,{name:r.oldTitle})}})},M=e=>{let t=F(),{activeOrganization:n}=(0,a.t)();return(0,u.uC)("/api/organizations/".concat(null==n?void 0:n.uuid,"/chat_conversations/").concat(e,"/title"),"POST",{onSuccess(n){let{title:r}=n;t(e,{name:null!=r?r:""})},meta:{noToast:!0}})};function G(e){var t,n;let r=(0,o.K)(e);return r+" "+e.attachments.map(e=>e.extracted_content).join(" ")+" "+((null===(t=e.content)||void 0===t?void 0:t.filter(e=>"tool_use"===e.type).map(e=>e.input?JSON.stringify(e.input):e.partial_json||"").join(" "))||"")+" "+((null===(n=e.content)||void 0===n?void 0:n.filter(e=>"tool_result"===e.type).flatMap(e=>e.content.filter(e=>"text"===e.type).map(e=>e.text)).join(" "))||"")}let L=e=>{let{activeOrganization:t}=(0,a.t)(),n=null==t?void 0:t.uuid;return(0,u.uC)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/stop_response"),"POST")},O=()=>{let{activeOrganization:e}=(0,a.t)(),t=null==e?void 0:e.uuid;return(0,u.uC)(e=>{let{conversation_uuid:n}=e;return"/api/organizations/".concat(t,"/chat_conversations/").concat(n,"/tool_result")},"POST",{enabled:!!t,meta:{errorMessage:"We could not record the tool result. Please try again later."},transformVariables:e=>{let{conversation_uuid:t,...n}=e;return n}})},N=e=>{let{activeOrganization:t}=(0,a.t)(),n=null==t?void 0:t.uuid;return(0,u.uC)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/current_leaf_message_uuid"),"PUT")},R=e=>{let{activeOrganization:t}=(0,a.t)(),n=(0,f.useQueryClient)(),r=null==t?void 0:t.uuid;return(0,u.Ne)("/api/organizations/".concat(r,"/chat_conversations/").concat(e,"?rendering_mode=raw"),"PUT",(e,t)=>t?{...t,settings:{...t.settings,...e.settings}}:void 0,{enabled:!!e,onSuccess:()=>{W(n,r)},queryKey:[s.I8,{orgUUID:r},{uuid:e}]})},W=async(e,t)=>{await Promise.all([e.invalidateQueries({queryKey:[s.tv,{orgUUID:t}]}),e.invalidateQueries({queryKey:[s.Dn,{orgUUID:t}]})])},H=e=>{let{activeOrganization:t}=(0,a.t)(),n=(0,f.useQueryClient)(),r=null==t?void 0:t.uuid;return(0,u.Ne)("/api/organizations/".concat(r,"/chat_conversations/").concat(e,"?rendering_mode=raw"),"PUT",(e,t)=>t?{...t,...e}:void 0,{onSuccess:()=>{W(n,r)},queryKey:[s.I8,{orgUUID:r},{uuid:e}]})}},1146:function(e,t,n){n.d(t,{Dk:function(){return f},Ef:function(){return l},FC:function(){return i},Gg:function(){return c},HX:function(){return v},QC:function(){return s},fX:function(){return y},kX:function(){return p},mj:function(){return _},vv:function(){return h},w$:function(){return d},wZ:function(){return o}});var r=n(45144),u=n(52221),a=n.n(u);let i="new-assistant-message-uuid",o="new-human-message-uuid",s="00000000-0000-4000-8000-000000000000",l=e=>e!==i;function c(e,t){let n=e.get(t);if(void 0===n){let e=Error("Key not found: ".concat(t));throw(0,r.Tb)(e),e}return n}let d=(e,t)=>{let n=null!=t?t:e.current_leaf_message_uuid;if(!n)return e;for(;n!==s;){var r;let t=c(e.parentByChildUuid,n),u=null===(r=c(e.childrenByParentUuid,t))||void 0===r?void 0:r.indexOf(n);e.selectedChildByUuid.set(t,u),n=t}return{...e,current_leaf_message_uuid:t}},f=e=>e.content?e:{...e,content:[{type:"text",text:e.text||"",citations:[]}]},g=e=>{var t,n,r;let u=new Map,a=new Map,i=new Map,o=new Map,l=new Map;if(0===e.chat_messages.length)return{messageByUuid:a,parentByChildUuid:i,childrenByParentUuid:o,selectedChildByUuid:l};let c=e.chat_messages.map(f);for(let e of c)u.set(e.index,e),a.set(e.uuid,e);for(let e of c){let t=e.parent_message_uuid;if(!t){let r=e.index-1;for(;!t&&r>=0;)t=null===(n=u.get(r))||void 0===n?void 0:n.uuid,r--}t=null!=t?t:s,i.set(e.uuid,t),o.set(t,(null!==(r=o.get(t))&&void 0!==r?r:[]).concat(e.uuid)),l.set(t,0)}if(!(null===(t=o.get(s))||void 0===t?void 0:t[0]))throw Error("No root message found");return{chat_messages:c,messageByUuid:a,parentByChildUuid:i,childrenByParentUuid:o,selectedChildByUuid:l}},y=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Set;for(let t of e.chat_messages)"assistant"===t.sender&&t.parent_message_uuid&&n.add(t.parent_message_uuid);let r=e.chat_messages.filter(e=>"assistant"===e.sender||n.has(e.uuid)||void 0===e.parent_message_uuid||t),u={...e,chat_messages:r},a={...u,...g(u)};return a.current_leaf_message_uuid||d(a),d(a,u.current_leaf_message_uuid)},v=e=>{let t=Array.from(e.messageByUuid.values()).map(e=>e.index);return 0===t.length?-1:Math.max(...t)},h=(e,t)=>{for(let r of(e.chat_messages=e.chat_messages.concat(t),t)){var n;if(!r.parent_message_uuid)throw Error("Parent UUID required");let t=r.parent_message_uuid;e.messageByUuid.set(r.uuid,r),e.parentByChildUuid.set(r.uuid,t);let u=null!==(n=e.childrenByParentUuid.get(t))&&void 0!==n?n:[];u.push(r.uuid),e.childrenByParentUuid.set(t,u),e.selectedChildByUuid.set(t,u.length-1)}return d(e,t[t.length-1].uuid)},p=(e,t)=>{let n=[],r=null!=t?t:s;for(;e.childrenByParentUuid.has(r);){let t=c(e.childrenByParentUuid,r);if(0===t.length)break;let u=c(e.selectedChildByUuid,r),a=c(e.messageByUuid,t[u]);n.push({...a,parent_message_uuid:r,nOptions:t.length,selectedOption:u}),r=a.uuid}return n};function _(e,t,n){var r;let u=c(e.parentByChildUuid,t.uuid),i=c(e.childrenByParentUuid,u),o=a()((null!==(r=t.selectedOption)&&void 0!==r?r:0)+n,0,i.length-1);e.selectedChildByUuid.set(u,o);let s=p(e,u);return d(e,s[s.length-1].uuid)}},1812:function(e,t,n){n.d(t,{I:function(){return o},T:function(){return i}});var r=n(27573),u=n(7653);let a=(0,u.createContext)(null),i=()=>{let e=(0,u.useContext)(a);return void 0===e?null:e},o=e=>{let{children:t,settings:n}=e;return(0,r.jsx)(a.Provider,{value:n,children:t})}},32737:function(e,t,n){n.d(t,{u:function(){return g}});var r=n(41596),u=n(27573),a=n(9788),i=n(85638),o=n(10607),s=n(68425);function l(){let e=(0,r._)(["\n  px-2\n  py-1\n  text-xs\n  font-medium\n  font-sans\n  leading-tight\n  rounded-md\n  shadow-md\n  text-white\n  bg-black/80\n  backdrop-blur\n  break-words\n  z-tooltip\n  max-w-[13rem]\n  [*:disabled_&]:hidden\n"]);return l=function(){return e},e}function c(){let e=(0,r._)(["\n  max-w-[337px]\n  z-tooltip\n  [*:disabled_&]:hidden\n"]);return c=function(){return e},e}function d(){let e=(0,r._)(["\n  p-1\n  text-xs\n  font-medium\n  font-sans\n  leading-tight\n  rounded-lg\n  shadow-md\n  text-white\n  bg-black/80\n  backdrop-blur\n  break-words\n  z-tooltip\n  max-w-[13rem]\n  [*:disabled_&]:hidden\n"]);return d=function(){return e},e}function f(){let e=(0,r._)(["\n  p-1\n  text-sm\n  font-normal\n  font-styrene\n  leading-tight\n  border-border-300\n  border-0.5\n  rounded-lg\n  shadow-diffused \n  shadow-[hsl(var(--always-black)/4%)]\n  text-text-100\n  bg-bg-100\n  break-words\n  z-tooltip\n  max-w-[13rem]\n  [*:disabled_&]:hidden\n"]);return f=function(){return e},e}function g(e){let{children:t,tooltipContent:n,contentStyle:r="default",side:a="top",sideOffset:s,align:l,className:c,delayDuration:d=200,...f}=e,g=h[r];return(0,u.jsx)(i.zt,{delayDuration:d,children:(0,u.jsxs)(i.fC,{...f,children:[(0,u.jsx)(i.xz,{asChild:!0,children:t}),(0,u.jsx)(i.h_,{children:(0,u.jsx)("span",{children:(0,u.jsx)(g,{className:(0,o.Z)(c,!n&&"hidden"),sideOffset:null!=s?s:5,side:a,align:l,children:n})})})]})})}let y=(0,a.q)(i.VY)(l()),v=(0,a.q)(i.VY)(c()),h={default:y,citation:e=>{let{children:t,...n}=e;return(0,u.jsx)(v,{...n,children:(0,u.jsx)(s.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},className:"p-1 text-sm font-normal font-styrene leading-tight text-text-200 bg-bg-100 break-words border-0.5 border-border-300/25 max-h-[300px] shadow-diffused shadow-[hsl(var(--always-black)/4%)] rounded-lg overflow-y-auto",children:t})})},inputMenu:(0,a.q)(i.VY)(d()),sampleImage:(0,a.q)(i.VY)(f())}},98731:function(e,t,n){n.d(t,{K:function(){return r}});let r=e=>{let t="";if(e.content)for(let n of e.content)"text"===n.type&&(t+=n.text);return t}},10228:function(e,t,n){var r,u,a,i;n.d(t,{Fg:function(){return r},co:function(){return u},hP:function(){return o},qC:function(){return s}}),(a=r||(r={})).GITHUB="github",a.GDRIVE="gdrive",a.OUTLINE="outlin",a.SALESFORCE="sfdc",a.GMAIL="gmail",a.GCAL="gcal",a.SLACK="slack",a.ASANA="asana";let o={github:"GitHub",gdrive:"Google Drive",outlin:"Outline",sfdc:"Salesforce",gmail:"Gmail",gcal:"Google Calendar",slack:"Slack",asana:"Asana"};(i=u||(u={})).CREATED="created",i.PENDING="pending",i.FAILED="failed",i.UPDATING="updating",i.UPDATE_FAILED="update_failed",i.READY="ready",i.UNAUTHENTICATED="unauthenticated",i.ACCESS_DENIED="access_denied",i.DISABLED="disabled";let s=["access_denied","failed","unauthenticated","update_failed"]},51432:function(e,t,n){n.d(t,{H:function(){return r}});let r=()=>void 0===crypto.randomUUID?"".concat(1e7,"-",1e3,"-",4e3,"-",8e3,"-",1e11).replace(/[018]/g,e=>{let t=parseInt(e);return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}):crypto.randomUUID()}}]);